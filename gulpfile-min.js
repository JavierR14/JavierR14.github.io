var gulp=require("gulp"),browserSync=require("browser-sync"),sass=require("gulp-sass"),prefix=require("gulp-autoprefixer"),minifycss=require("gulp-minify-css"),jshint=require("gulp-jshint"),concat=require("gulp-concat"),uglify=require("gulp-uglify"),rename=require("gulp-rename"),cp=require("child_process"),jade=require("gulp-jade"),bourbon=require("bourbon").includePaths,messages={jekyllBuild:'<span style="color: grey">Running:</span> $ jekyll build'};gulp.task("jekyll-build",function(s){browserSync.notify(messages.jekyllBuild);var e="jekyll.bat";return cp.spawn(e,["build"],{stdio:"inherit"}).on("close",s)}),gulp.task("jekyll-rebuild",["jekyll-build"],function(){browserSync.reload()}),gulp.task("browser-sync",["sass","js","jekyll-build"],function(){browserSync({server:{baseDir:"_site"},notify:!1})}),gulp.task("sass",function(){return gulp.src("assets/css/main.scss").pipe(sass({includePaths:["css"],onError:browserSync.notify})).pipe(prefix(["last 15 versions","> 1%","ie 8","ie 7"],{cascade:!0})).pipe(gulp.dest("_site/assets/css")).pipe(browserSync.reload({stream:!0})).pipe(gulp.dest("assets/css"))}),gulp.task("jade",function(){return gulp.src("_jadefiles/*.jade").pipe(jade()).pipe(gulp.dest("_includes"))}),gulp.task("js",function(){return gulp.src("js/common.js").pipe(jshint()).pipe(jshint.reporter("default")).pipe(concat("common.js")).pipe(gulp.dest("js")).pipe(rename({suffix:".min"})).pipe(uglify()).pipe(gulp.dest("js")).pipe(gulp.dest("_site/js"))}),gulp.task("watch",function(){gulp.watch("assets/js/**/*.js",["js"]).on("change",browserSync.reload),gulp.watch("assets/css/**",["sass"]),gulp.watch(["*.html","_layouts/*.html","_posts/*","_includes/*"],["jekyll-rebuild"]),gulp.watch("_jadefiles/*.jade",["jade"])}),gulp.task("default",["browser-sync","watch"]);